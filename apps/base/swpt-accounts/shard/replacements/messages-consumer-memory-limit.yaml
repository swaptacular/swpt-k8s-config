source:
  kind: ConfigMap
  name: shardconfig
  fieldPath: metadata.annotations.kustomize_messages_consumer_memory_limit
targets:
  - select:
      kind: Deployment
      name: messages-consumer
    fieldPaths:
      - spec.template.spec.containers.[name=messages-consumer].resources.limits.memory
      - spec.template.spec.initContainers.[name=await-migrations].resources.limits.memory
    options:
      create: true
  - select:
      kind: Deployment
      name: messages-drainer
    fieldPaths:
      - spec.template.spec.containers.[name=messages-drainer].resources.limits.memory
      - spec.template.spec.initContainers.[name=await-migrations].resources.limits.memory
    options:
      create: true

