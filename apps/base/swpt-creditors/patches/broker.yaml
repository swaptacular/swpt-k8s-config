- op: test
  path: /metadata/labels
  value: null
- op: add
  path: /metadata/labels
  value:
    app.kubernetes.io/name: swpt-creditors
    app.kubernetes.io/component: message-broker

- op: test
  path: /spec/affinity
  value: null
- op: add
  path: /spec/affinity
  value:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchLabels:
            app.kubernetes.io/name: broker
        topologyKey: kubernetes.io/hostname

- op: test
  path: /spec/override
  value: null
- op: add
  path: /spec/override
  value:
    statefulSet:
      spec:
        template:
          spec:
            priorityClassName: critical-database
            containers:
            - name: rabbitmq

- op: add
  path: /spec/rabbitmq/additionalPlugins/0
  value: rabbitmq_random_exchange
