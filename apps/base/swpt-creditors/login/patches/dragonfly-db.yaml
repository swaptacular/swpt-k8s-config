- op: test
  path: /metadata/name
  value: dragonfly-db

- op: test
  path: /metadata/labels
  value: null
- op: add
  path: /metadata/labels
  value:
    app.kubernetes.io/instance: dragonfly-db
    app.kubernetes.io/name: dragonfly

- op: test
  path: /spec/labels
  value: null

- op: test
  path: /spec/affinity
  value: null
- op: add
  path: /spec/affinity
  value:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchLabels:
            app.kubernetes.io/name: dragonfly
        topologyKey: kubernetes.io/hostname
    nodeAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 1
        preference:
          matchExpressions:
          - operator: In
            values: []
- op: copy
  from: /spec/tolerations/0/key
  path: /spec/affinity/nodeAffinity/preferredDuringSchedulingIgnoredDuringExecution/0/preference/matchExpressions/0/key
- op: copy
  from: /spec/tolerations/0/value
  path: /spec/affinity/nodeAffinity/preferredDuringSchedulingIgnoredDuringExecution/0/preference/matchExpressions/0/values/-

- op: test
  path: /spec/priorityClassName
  value: null
- op: add
  path: /spec/priorityClassName
  value: login-database

- op: test
  path: /spec/authentication
  value: null
- op: add
  path: /spec/authentication
  value:
    passwordFromSecret:
      name: db-owner-credentials
      key: password

- op: test
  path: /spec/args
  value: null
- op: add
  path: /spec/args
  value:
    - "--dbfilename=snapshot"

- op: test
  path: /spec/imagePullSecrets
  value: null
- op: add
  path: /spec/imagePullSecrets
  value:
    - name: regcreds
